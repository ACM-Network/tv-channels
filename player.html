<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACM Network Player</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.6.8/plyr.css"> <!-- Plyr CSS -->
    <link rel="stylesheet" href="styles.css"> <!-- Your custom CSS -->
</head>
<body>
    <header>
        <h1>ACM Network Player</h1>
    </header>

    <main>
        <div id="playerContainer">
            <video controls crossorigin playsinline id="player">
                <source src="" type="application/x-mpegURL">
            </video>
        </div>
    </main>

    <footer>
        <p>ACM Network &copy; 2024</p>
    </footer>

    <script src="https://cdn.plyr.io/3.6.8/plyr.polyfilled.js"></script> <!-- Plyr JS -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script> <!-- Hls.js for HLS support -->
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const streamUrl = urlParams.get('url');
        const videoElement = document.getElementById('player');

        function initPlyr() {
            const player = new Plyr(videoElement, {
                controls: [
                    'play-large', 'rewind', 'play', 'fast-forward', 'progress', 'current-time', 'duration',
                    'mute', 'volume', 'captions', 'settings', 'pip', 'airplay', 'download', 'fullscreen'
                ],
                settings: ['captions', 'quality', 'speed', 'loop', 'audio', 'audio-track'],
                tooltips: { controls: false, seek: true },
                displayDuration: true,
                invertTime: false,
                i18n: {
                    restart: 'Restart',
                    rewind: 'Rewind {seektime}s',
                    play: 'Play',
                    pause: 'Pause',
                    fastForward: 'Forward {seektime}s',
                    seek: 'Seek',
                    seekLabel: '{currentTime} of {duration}',
                    played: 'Played',
                    buffered: 'Buffered',
                    currentTime: 'Current time',
                    duration: 'Duration',
                    volume: 'Volume',
                    mute: 'Mute',
                    unmute: 'Unmute',
                    enableCaptions: 'Enable captions',
                    disableCaptions: 'Disable captions',
                    download: 'Download',
                    enterFullscreen: 'Enter fullscreen',
                    exitFullscreen: 'Exit fullscreen',
                    frameTitle: 'Player for {title}',
                    captions: 'Captions',
                    settings: 'Settings',
                    pip: 'PIP',
                    menuBack: 'Go back to previous menu',
                    speed: 'Speed',
                    normal: 'Normal',
                    quality: 'Quality',
                    loop: 'Loop'
                }
            });

            player.on('playing', () => console.log('Video is playing'));
            player.on('waiting', () => console.log('Buffering...'));
            player.on('enterfullscreen', () => console.log('Entered fullscreen'));
            player.on('exitfullscreen', () => console.log('Exited fullscreen'));
            player.on('captionsenabled', () => console.log('Captions enabled'));
            player.on('captionsdisabled', () => console.log('Captions disabled'));
            player.on('languagechange', () => console.log('Language changed'));
            player.on('qualitychange', event => console.log('Quality changed to', event.detail.quality));
            player.on('ratechange', () => console.log('Playback rate changed'));
            player.on('volumechange', () => console.log('Volume changed'));
        }

        function initOtherPlayer() {
            console.log('Initializing other player...');
            // Logic for other player goes here
        }

        if (streamUrl) {
            // Example condition to choose the player (you can replace this with your own logic)
            if (streamUrl.includes('example1')) {
                if (Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(streamUrl);
                    hls.attachMedia(videoElement);

                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        videoElement.play().catch(error => {
                            console.log('Autoplay was prevented:', error);
                        });
                    });
                } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                    videoElement.src = streamUrl;
                    videoElement.addEventListener('loadedmetadata', function() {
                        videoElement.play().catch(error => {
                            console.log('Autoplay was prevented:', error);
                        });
                    });
                } else {
                    videoElement.src = streamUrl;
                    videoElement.addEventListener('loadedmetadata', function() {
                        videoElement.play().catch(error => {
                            console.log('Autoplay was prevented:', error);
                        });
                    });
                }

                initPlyr();
            } else {
                initOtherPlayer();
            }
        }
    </script>
</body>
</html>
